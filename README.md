# 『Puzzle & Monsters』

## ⚔️ ゲーム概要

1.  ゲームタイトルは「**Puzzle & Monsters**」(略して**Puzmon**)とする。
2.  プレイヤーは、ゲームスタート時点で4匹の味方モンスター (清龍、朱雀、白虎、玄武) を従えている。
3.  プレイヤーは、ゲームスタート直後に4匹の味方モンスターとパーティを編成してダンジョンに行く。
4.  ダンジョンでは**5回のバトル**が発生し、すべてのバトルで敵モンスターのHPを0にすれば**ゲームクリア**。  
    途中でパーティーのHPが0になると**ゲームオーバー**。
5.  各バトルは、パーティ対敵モンスター1匹の構図で戦う。敵モンスターのHPを0にすると次のバトルに進む。
6.  バトルで戦う相手は、登場順に「**スライム**」「**ゴブリン**」「**オオコウモリ**」「**ウェアウルフ**」「**ドラゴン**」とする。
7.  ゲーム終了時には、「**GAME OVER!!**」または「**GAME CLEARED!!**」のメッセージとともに、  
    倒した敵モンスターの数を表示する。

---

### ❤️ パラメータの概要

1.  敵モンスターのパラメータは、**名前**、**HP**、**最大HP**、**属性**、**攻撃力**、**防御力**とする。
2.  味方モンスターのパラメータは、敵モンスターのパラメータと同じとする。
3.  パーティのパラメータは、**プレイヤー名**、**4匹の味方モンスター**、パーティの**HP**および**最大HP**、**防御力**とする。
4.  パーティ編成時、パーティにに参加している味方モンスターのHPの合計値がパーティのHPおよび最大HPとなる。  
    また、味方モンスターの防御力の平均値がパーティの防御力となる。
5.  ダンジョン内のバトルでは、パーティのHPが増減し、味方モンスターごとのHPは増減しない。

---

### 👾 モンスター基本情報

敵・味方モンスターのパラメータは以下のとおりとする。

#### 敵モンスター

| 名前         | HP  | 最大HP | 属性 | 攻撃力 | 防御力 |
| :----------- | :-- | :----- | :--- | :----- | :----- |
| スライム     | 100 | 100    | 水   | 10     | 1      |
| ゴブリン     | 200 | 200    | 土   | 20     | 5      |
| オオコウモリ | 300 | 300    | 風   | 30     | 10     |
| ウェアウルフ | 400 | 400    | 風   | 40     | 15     |
| ドラゴン     | 600 | 600    | 火   | 50     | 20     |

#### 味方モンスター

| 名前 | HP  | 最大HP | 属性 | 攻撃力 | 防御力 |
| :--- | :-- | :----- | :--- | :----- | :----- |
| 青龍 | 150 | 150    | 風   | 15     | 10     |
| 朱雀 | 150 | 150    | 火   | 25     | 10     |
| 白虎 | 150 | 150    | 土   | 20     | 5      |
| 玄武 | 150 | 150    | 水   | 20     | 15     |

---

### 🔥 属性システム

1.  「PuzMon」の世界には**6つの属性**が存在し、モンスターや宝石は必ずいずれかの属性を持っている。

#### 属性

| 属性 | 英語名 | 記号         | 色   | 色コード |
| :--- | :----- | :----------- | :--- | :------- |
| 火   | FIRE   | `` `$` ``    | 赤   | 1        |
| 水   | WATER  | `` `~` ``    | 水色 | 6        |
| 風   | WIND   | `` `@` ``    | 緑   | 2        |
| 土   | EARTH  | `` `#` ``    | 黄色 | 3        |
| 命   | LIFE   | `` `&` ``    | 紫   | 5        |
| 無   | EMPTY  | (半角空白)   | 黒   | 7        |

2.  属性には次の4つの強弱関係がある。これ以外の関係は存在しない。  
    　　**水 ＞ 火　火 ＞ 風　風 ＞ 土　土 ＞ 水**

---

### 🤜 バトルシステム

1.  バトルは、味方のターンと敵のターンが交互に行われ、相手方に対してHPを減らす攻撃を行う。
2.  バトルは、味方パーティと敵モンスター1匹で行われ、どちらかのHPが0以下になるまで続く。
3.  バトルで敵を倒して次のバトルに進んでも、パーティのHPは回復しない。
4.  バトルが行われる場を**バトルフィールド**といい、ここには**14個の宝石置き場 (スロット)** が存在する。  
    各スロットには、左から順に**A~Nの記号**が降られている。
5.  バトル開始時には、各スロットにはすでに**14個の宝石 (Gem)** が並んでいる。  
    宝石は「無」を除く**5種類のいずれか**である。
6.  プレイヤーはスロットに置かれた宝石を動かして、味方モンスターに攻撃させたり、HPを回復したりしてバトルを進める。
7.  プレイヤーは、「**AD**」などの2文字のアルファベットによるコマンドを入力して宝石を動かす。  
    これは「Aスロットの宝石をDスロットへ移動させる」という意味である。
8.  宝石は、隣と1つずつ交換しながら目的の位置まで移動する。  
    たとえば「AD」コマンドの場合、「AとBを交換」「BとCを交換」「CとDを交換」という3回の交換を経て移動する。

9.  宝石は**同じ属性のものが3つ以上隙間なく並ぶと消滅**し、次の効果を発揮する。
    * **火の宝石**：火属性の味方モンスターが攻撃
    * **水の宝石**：水属性の味方モンスターが攻撃
    * **風の宝石**：風属性の味方モンスターが攻撃
    * **土の宝石**：土属性の味方モンスターが攻撃
    * **命の宝石**：命属性の味方モンスターが攻撃

10. バトル開始時に偶然同じ属性の宝石が3つ以上並んでいても消滅しない。
11. 宝石が消滅して生じた空きスロットは、それより右側に並んでいる宝石が左にずれて詰められる (**空き詰め**)。  
    これにより、さらに3つ以上の同族性の宝石が並んだ場合、それらが消滅して効果が発生する (**詰めコンボ**)。
12. 3つ以上の同族性の並びが2組以上発生した場合は、同時に消滅せずに  
    より左の組から順に消滅する (空き詰めと評価処理を優先)。
13. 空き詰め終了後、空きスロット部分にはランダムに宝石が発生する。これにより  
    3つ以上の同属性の宝石が並んだ場合、それらが消滅して効果が発生する (**湧きコンボ**)。
14. コンボ数は、コマンド入力での宝石移動による最初の消滅を1とし、以後、次の宝石移動までの間に  
    発生した消滅のたびに1つずつ増加する。詰めコンボと湧きコンボは、発生原因は異なるがどちらもコンボ数を1増やす。
15. コンボ数は**2以上**で宝石が消滅するとき、画面には「**2COMBO!**」などのコンボ発生の事実を表示する。

---

### 📕 ダメージルール

1.  バトルにおけるダメージと回復量は、いかに示す式により決定する。  
    なお、「**±〇%**」とは、その値を基準値として、-〇% ~ +〇% の幅でのランダムな変動を意味する。

2.  敵によるパーティへの攻撃ダメージ  
    ` (敵の攻撃力 - パーティの防御力) ± 10% `  
    ※ **0以下の場合は1とする**。

3.  味方モンスターによる敵へのダメージ  
    ` (モンスターの攻撃力 - 敵防御力) × 属性補正 × コンボ補正 ± 10% `

    <details><summary>※ 属性補正</summary>

    『**属性補正**』
    * 強属性モンスターから弱属性モンスターへの攻撃：**2.0**
    * 弱属性モンスターから強属性モンスターへの攻撃：**0.5**
    * それ以外：**1.0**

    </details>
    <details><summary>※ コンボ補正</summary>

    『**コンボ補正**』
    `1.5 ^ {消滅した宝石数 - 3 + コンボ数}`

    </details>  
    ※ **`0`未満の場合は1とする。**

4.  属性補正  
    * 強属性モンスターから弱属性モンスターへの攻撃：**2.0**
    * 弱属性モンスターから強属性モンスターへの攻撃：**0.5**
    * それ以外：**1.0**

5.  コンボ補正  
    `1.5 ^ {消滅した宝石数 - 3 + コンボ数}`  
    ※ `a^b` は累乗 (aのb乗) を表す。

    <details><summary>※ コンボ数</summary>

    『**コンボ数**』
    コンボ数は、コマンド入力での宝石移動による最初の消滅を1とし、  
    以後、次の宝石移動までの間に発生した消滅のたびに1つずつ増加する。  
    詰めコンボと湧きコンボは、発生原因は異なるがどちらもコンボ数を1増やす。  

    </details>

6.  命属性の宝石消滅によるHPの回復量  
    ` (20 × コンボ補正) ± 10% `